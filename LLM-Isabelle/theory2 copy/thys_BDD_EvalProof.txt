theory EvalProof imports ProcedureSpecs begin

lemma (in Eval_impl) Eval_modifies:
  shows "\<forall>\<sigma>. \<Gamma>\<turnstile>{\<sigma>}  PROC Eval (\<acute>p, \<acute>varval, \<acute>R) 
                {t. t may_not_modify_globals \<sigma>}"
  apply (hoare_rule HoarePartial.ProcRec1)
  apply (vcg spec=modifies)
  done 


lemma (in Eval_impl) Eval_spec:
  shows "\<forall>\<sigma> t bdt1. \<Gamma>\<turnstile>
  \<lbrace>\<sigma>. Dag \<acute>p \<acute>low \<acute>high t \<and> bdt t \<acute>var = Some bdt1\<rbrace> 
   \<acute>R :== PROC Eval(\<acute>p, \<acute>varval) 
  \<lbrace>\<acute>R = eval bdt1 \<^bsup>\<sigma>\<^esup>varval \<rbrace>"
apply (hoare_rule HoarePartial.ProcRec1)
apply vcg
apply clarsimp
apply safe
apply    (case_tac bdt1)
apply      simp
apply     fastforce
apply    fastforce
apply   simp
apply   (case_tac bdt1)
apply     fastforce
apply    fastforce
apply   fastforce
apply  (case_tac bdt1)
apply    fastforce
apply   fastforce
apply  fastforce
apply (case_tac bdt1)
apply   fastforce
apply  fastforce
apply fastforce
done



end
