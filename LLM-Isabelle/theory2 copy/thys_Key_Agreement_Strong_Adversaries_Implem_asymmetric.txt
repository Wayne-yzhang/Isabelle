theory Implem_asymmetric
imports Implem
begin


fun implem_asym :: "chan \<Rightarrow> msg" where
  "implem_asym (Insec A B M) = \<langle>InsecTag, Agent A, Agent B, M\<rangle>"
 |"implem_asym (Confid A B M) = Aenc \<langle>Agent A, M\<rangle> (pubK B)"
 |"implem_asym (Auth A B M) = Sign \<langle>Agent B, M\<rangle> (priK A)"
 |"implem_asym (Secure A B M) = Sign (Aenc \<langle>SecureTag, Agent A, M\<rangle> (pubK B)) (priK A)"


interpretation asym: basic_implem implem_asym
done



\<close>
text \<open>These auxiliary definitions are overapproximations.\<close>
subsection \<open>Lemmas to pull implementation sets out of @{term analz}\<close>
text \<open>
All these proofs are similar:
\begin{enumerate}
\item prove the lemma for the @{term "implSet_aux"} and with the set added outside of  
  @{term analz} given explicitly,
\item prove the lemma for the @{term "implSet_aux"} but with payload, and
\item prove the lemma for the @{term "implSet"}.
\end{enumerate}
There  are two cases for the confidential and secure messages:
the general case (the payloads stay in @{term  analz}) and the case where the key is unknown
(the messages cannot be opened and are completely removed from the @{term analz}).
\<close>
subsubsection \<open>Pull @{term PairAgentSet} out of \<open>analz\<close>\<close>
subsubsection \<open>Pull @{term implInsecSet} out of @{term analz}\<close>
subsection \<open>Pull @{term implConfidSet} out of @{term analz}\<close>
text \<open>Pull @{term implConfidSet} out of @{term analz}, 2nd case where the agents are honest.\<close>
subsection \<open>Pull @{term implAuthSet} out of @{term analz}\<close>
subsection \<open>Pull @{term implSecureSet} out of @{term analz}\<close>
text \<open>
Pull @{term implSecureSet} out of @{term analz}, 2nd case, where the agents are honest. 
\<close>
subsection \<open>Locale interpretations\<close>
      using parts_singleton [OF \<open>Enc X Y \<in> parts I\<close>] \<open>I \<subseteq> asym.valid\<close>
text \<open>
Third step: @{locale "valid_implem"}. The lemmas giving conditions on $M$, $A$ and $B$ for 
@{prop [display] "implXXX A B M \<in> synth (analz Z)"}.
\<close>
        using parts_singleton [OF \<open>Aenc \<langle>SecureTag, Agent A, M\<rangle> (pubK B) \<in> parts H\<close>] 
