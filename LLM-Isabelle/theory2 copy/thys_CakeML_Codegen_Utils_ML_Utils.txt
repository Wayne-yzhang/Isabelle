theory ML_Utils
imports
  "HOL-Library.FSet"
  "Dict_Construction.Dict_Construction"
begin

ML_file "utils.ML"


lemma norm_all_conjunction:
  "\<And>P Q. ((\<And>x. PROP P x) &&& PROP Q) \<equiv> (\<And>x. PROP P x &&& PROP Q)"
  "\<And>P Q. (PROP P &&& (\<And>x. PROP Q x)) \<equiv> (\<And>x. PROP P &&& PROP Q x)"
proof -
  show "((\<And>x. PROP P x) &&& PROP Q) \<equiv> (\<And>x. PROP P x &&& PROP Q)" for P Q
    proof
      fix x
      assume "(\<And>x. PROP P x) &&& PROP Q"
      note Pure.conjunctionD1[OF this, rule_format] Pure.conjunctionD2[OF this]
      thus "PROP P x &&& PROP Q" .
    next
      assume "(\<And>x. PROP P x &&& PROP Q)"
      note Pure.conjunctionD1[OF this] Pure.conjunctionD2[OF this]
      thus "(\<And>x. PROP P x) &&& PROP Q" .
    qed
next
  show "(PROP P &&& (\<And>x. PROP Q x)) \<equiv> (\<And>x. PROP P &&& PROP Q x)" for P Q
    proof
      fix x
      assume "PROP P &&& (\<And>x. PROP Q x)"
      note Pure.conjunctionD1[OF this] Pure.conjunctionD2[OF this, rule_format]
      thus "PROP P &&& PROP Q x" .
    next
      assume "(\<And>x. PROP P &&& PROP Q x)"
      note Pure.conjunctionD1[OF this] Pure.conjunctionD2[OF this]
      thus "PROP P &&& (\<And>x. PROP Q x)" .
    qed
qed


end