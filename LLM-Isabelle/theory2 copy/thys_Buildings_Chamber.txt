  Now we develop the basic theory of chamber complexes, including both thin and thick complexes.
  Some terminology: a maximal simplex is now called a chamber, and a chain (with respect to
  adjacency) of chambers is now called a gallery. A gallery in which no chamber appears more than
  once is called proper, and we use the prefix p as a naming convention to denote proper.
  Again, we remind the reader that some sources reserve the name gallery for (a slightly weaker
  notion of) what we are calling a proper gallery, using pregallery to denote an improper gallery.
\<close>
subsection \<open>Locale definition and basic facts\<close>
subsection \<open>The system of chambers and distance between chambers\<close>
text \<open>
  We now examine the system of all chambers in more detail, and explore the distance function on
  this system provided by lengths of minimal galleries.
\<close>
subsection \<open>Labelling a chamber complex\<close>
text \<open>
  A labelling of a chamber complex is a function on the vertex set so that each chamber is in
  bijective correspondence with the label set (chambers all have the same number of vertices).
\<close>
subsection \<open>Morphisms of chamber complexes\<close>
text \<open>
  While any function on the vertex set of a simplicial complex can be considered a morphism of
  simplicial complexes onto its image, for chamber complexes we require the function send chambers
  onto chambers of the same cardinality in some chamber complex of the codomain.
\<close>
subsubsection \<open>Morphism locale and basic facts\<close>
subsubsection \<open>Action on pregalleries and galleries\<close>
subsubsection \<open>Properties of the image\<close>
subsubsection \<open>Action on the chamber system\<close>
subsubsection \<open>Isomorphisms\<close>
subsubsection \<open>Endomorphisms\<close>
  \<comment> \<open>to facilitate uniqueness arguments\<close>
subsubsection \<open>Automorphisms\<close>
  \<comment> \<open>to facilitate uniqueness arguments\<close>
subsubsection \<open>Retractions\<close>
text \<open>A retraction of a chamber complex is an endomorphism that is the identity on its image.\<close>
subsubsection \<open>Foldings of chamber complexes\<close>
text \<open>
  A folding of a chamber complex is a retraction that literally folds the complex in half, in that
  each chamber in the image is the image of precisely two chambers: itself (since a folding is a
  retraction) and a unique chamber outside the image.
\<close>
paragraph \<open>Locale definition\<close>
text \<open>
  Here we define the locale and collect some lemmas inherited from the
  @{const ChamberComplexRetraction} locale.
\<close>
paragraph \<open>Decomposition into half chamber systems and half apartments\<close>
text \<open>
  Here we describe how a folding splits the chamber system of the complex into its image and the
  complement of its image. The chamber subcomplex consisting of all simplices contained in a
  chamber of a given half of the chamber system is called a half-apartment.
\<close>
paragraph \<open>Mapping between half chamber systems for foldings\<close>
text \<open>
  Since each chamber in the image of the folding is the image of a unique chamber in the complement
  of the image, we obtain well-defined functions from one half chamber system to the other.
\<close>
subsection \<open>Thin chamber complexes\<close>
text \<open>
  A thin chamber complex is one in which every facet is a facet in exactly two chambers. Slightly
  more generally, we first consider the case of a chamber complex in which every facet is a facet
  of at most two chambers. One of the main results obtained at this point is the so-called standard
  uniqueness argument, which essentially states that two morphisms on a thin chamber complex that
  agree on a particular chamber must in fact agree on the entire complex. Following that, foldings
  of thin chamber complexes are investigated. In particular, we are interested in pairs of opposed
  foldings.
\<close>
subsubsection \<open>Locales and basic facts\<close>
  \<comment> \<open>being adjacent to a chamber, such a @{term D} would also be a chamber (see lemma
@{text "chamber_adj"})\<close>
subsubsection \<open>The standard uniqueness argument for chamber morphisms of thin chamber complexes\<close>
subsection \<open>Foldings of thin chamber complexes\<close>
subsubsection \<open>Locale definition and basic facts\<close>
subsubsection \<open>Pairs of opposed foldings\<close>
text \<open>
  A pair of foldings of a thin chamber complex are opposed or opposite if there is a corresponding
  pair of adjacent chambers, where each folding sends its corresponding chamber to the other
  chamber.
\<close>
\<comment> \<open>@{term f} and @{term g} will both be the identity on the intersection\<close>
subsubsection \<open>The automorphism induced by a pair of opposed foldings\<close>
text \<open>
  Recall that a folding of a chamber complex is a special kind of chamber complex retraction, and
  so is the identity on its image. Hence a pair of opposed foldings will be the identity on the
  intersection of their images and so we can stitch them together to create an automorphism of the
  chamber complex, by allowing each folding to act on the complement of its image.
  This automorphism will be of order two, and will be the unique automorphism of the chamber
  complex that fixes pointwise the facet shared by the pair of adjacent chambers associated to the
  opposed foldings.
\<close>
\<comment> \<open>@{term f} and @{term g} will both be the identity on the intersection of their images\<close>
subsubsection \<open>Walls\<close>
text \<open>
  A pair of opposed foldings of a thin chamber complex defines a decomposition of the chamber
  system into the two disjoint chamber system images. Call such a decomposition a wall, as we image
  that disjointness erects a wall between the two half chamber systems. By considering the
  collection of all possible opposed folding pairs, and their associated walls, we can obtain
  information about minimality of galleries by considering the walls they cross.
\<close>
subsection \<open>Thin chamber complexes with many foldings\<close>
text \<open>
  Here we begin to examine thin chamber complexes in which every pair of adjacent chambers affords a
  pair of opposed foldings of the complex. This condition will ultimately be shown to be sufficient
  to ensure that a thin chamber complex is isomorphic to some Coxeter complex.
\<close>
subsubsection \<open>Locale definition and basic facts\<close>
subsubsection \<open>The group of automorphisms\<close>
text \<open>
  Recall that a pair of opposed foldings of a thin chamber complex can be stitched together to form
  an automorphism of the complex. Choosing an arbitrary chamber in the complex to act as a sort of
  centre of the complex (referred to as the fundamental chamber), we consider the group (under
  composition) generated by the automorphisms afforded by the chambers adjacent to the fundamental
  chamber via the pairs of opposed foldings that we have assumed to exist.
\<close>
subsubsection \<open>Action of the group of automorphisms on the chamber system\<close>
text \<open>
  Now we examine the action of the group @{term W} on the chamber system. In particular, we show
  that the action is transitive.
\<close>
subsubsection \<open>A labelling by the vertices of the fundamental chamber\<close>
text \<open>
  Here we show that by repeatedly applying the composition of all the elements in the collection
  @{term S} of fundamental automorphisms, we can retract the entire chamber complex onto the
  fundamental chamber. This retraction provides a means of labelling the chamber complex, using the
  vertices of the fundamental chamber as labels.
\<close>
  \<comment> \<open>for @{term "fg \<in> set fgs"}, have @{term "(fst fg) ` D = C0"} for some @{term "D \<in> fundajdset"}\<close>
subsubsection \<open>More on the action of the group of automorphisms on chambers\<close>
text \<open>
  Recall that we have already verified that @{term W} acts transitively on the chamber system. We
  now use the labelling of the chamber complex examined in the previous section to show that this
  action is simply transitive.
\<close>
subsubsection \<open>A bijection between the fundamental chamber and the set of generating automorphisms\<close>
text \<open>
  Removing a single vertex from the fundamental chamber determines a facet, a facet in the
  fundamental chamber determines an adjacent chamber (since our complex is thin), and a chamber
  adjacent to the fundamental chamber determines an automorphism (via some pair of opposed foldings)
  in our generating set @{term S}. Here we show that this correspondence is bijective.
\<close>
subsection \<open>Thick chamber complexes\<close>
text \<open>
  A thick chamber complex is one in which every facet is a facet of at least three chambers.
\<close>
