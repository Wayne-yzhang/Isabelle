theory Refine_Dflt
imports 
  Refine_Monadic.Refine_Monadic
  "GenCF/GenCF"
  "Lib/Code_Target_ICF"
begin


lemmas tyrel_dflt_nat_set = 
  ty_REL[where 'a="nat set" and R="\<langle>Id\<rangle>dflt_rs_rel"]

lemmas tyrel_dflt_bool_set = 
  ty_REL[where 'a="bool set" and R="\<langle>Id\<rangle>list_set_rel"]

lemmas tyrel_dflt_nat_map = 
  ty_REL[where R="\<langle>nat_rel,Rv\<rangle>dflt_rm_rel"] for Rv

lemmas tyrel_dflt_old = tyrel_dflt_nat_set tyrel_dflt_bool_set tyrel_dflt_nat_map

lemmas tyrel_dflt_linorder_set = 
  ty_REL[where R="\<langle>Id::('a::linorder\<times>'a) set\<rangle>dflt_rs_rel"]
  
lemmas tyrel_dflt_linorder_map = 
  ty_REL[where R="\<langle>Id::('a::linorder\<times>'a) set,R\<rangle>dflt_rm_rel"] for R
  
lemmas tyrel_dflt_bool_map = 
  ty_REL[where R="\<langle>Id::(bool\<times>bool) set,R\<rangle>list_map_rel"] for R

lemmas tyrel_dflt = tyrel_dflt_linorder_set tyrel_dflt_bool_set tyrel_dflt_linorder_map tyrel_dflt_bool_map

declare tyrel_dflt[autoref_tyrel]





text "Fallbacks"

context begin
  by autoref
private lemmas asm_rl[of "_\<in>\<langle>int_rel\<rangle>dflt_rs_rel", OF test_dflt_tyrel1]

  by autoref
private lemmas asm_rl[of "_\<in>\<langle>bool_rel\<rangle>list_set_rel", OF test_dflt_tyrel2]

  by autoref
private lemmas asm_rl[of "_\<in>\<langle>int_rel,nat_rel\<rangle>dflt_rm_rel", OF test_dflt_tyrel3]

  by autoref
private lemmas asm_rl[of "_\<in>\<langle>bool_rel,nat_rel\<rangle>list_map_rel", OF test_dflt_tyrel4]

end





end
