theory IP_Address_Parser
imports IP_Address
        IPv4
        IPv6
begin






  definition mk_ipv6addr :: "16 word option list \<Rightarrow> ipv6addr_syntax option" where
    "mk_ipv6addr partslist = (
          fix_start = (\<lambda>ps. case ps of None#None#_ \<Rightarrow> tl ps | _ \<Rightarrow> ps);
          fix_end = (\<lambda>ps. case rev ps of None#None#_ \<Rightarrow> butlast ps | _ \<Rightarrow> ps);
          ps = (fix_end \<circ> fix_start) partslist
      in
      if length (filter (\<lambda>p. p = None) ps) = 1
      then ipv6_unparsed_compressed_to_preferred ps
      else case ps of [Some a,Some b,Some c,Some d,Some e,Some f,Some g,Some h]
                              \<Rightarrow> Some (IPv6AddrPreferred a b c d e f g h)
                   |  _ \<Rightarrow> None
      )"


end
